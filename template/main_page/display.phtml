<?
$this->title = "Live the life through other people's eyes";
$this->menu = 'journal';
?>
{{wrap with="layout.phtml"}}
  {{into slot="js_include"}}
    <script src="/app/journal.js"></script>
    <script src="/lib/vendor/jquery.imagesloaded.min.js"></script>
  {{/into}}

  {{into slot="js"}}
    var days_data = <?= json_encode($this->days); ?>;
  {{/into}}

  {{template name='day_expand_button'}}
    <div class="input-prepend small with-tooltip" data-original-title="Read full day">
      <span class="add-on">
        <i class="icon-eye-open"></i>
        {$day->views_count}
      </span>
      <a class="btn btn-small has-spinner action-expand" href="/pages/{$day.id}/day">
        <span class="spinner icon-spin icon-refresh"></span>
        Read this day &darr;
      </a>
    </div>
  {{/template}}

  {{template name='day_comments_button'}}
    <div class="input-prepend small with-tooltip" data-original-title="Scroll to comments">
      <span class="add-on"><i class="icon-comments"></i> {$day->comments_count}</span>
      <a class="btn btn-small" href="/pages/{$day.id}/day#comments">Comments</a>
    </div>
  {{/template}}

  {{into slot="templates"}}
    <script id="template_moments" type="text/x-handlebars-template">
      [[#moments]]
        <article class="well">
          <div class="time text-center text-gray">
            <time class="text-center text-gray"><i class="icon-time"></i> [[time]]</time>
          </div>

          <div class="image block-center">
            <div class="thumbnail">
              <img src="[[image_532]]" />
            </div>
          </div>
          [[#if description]]
            <div class="description bubble block-center">
              <div class="no-overflow">
                [[description]]
              </div>
            </div>
          [[/if]]
        </article>
      [[/moments]]
    </script>
  {{/into}}

  {{into slot="content"}}
		<div id="fullscreen-spinner" style="display:none;">
			<i class="icon-spin icon-refresh"></i>
		</div>
		<div class="row-fluid">
			<div class="span8">
				{{list using="$#days"}}
				<div class="journal has-spinner">
					{{list:item}}
						{{apply template="journal_item" item="$item" /}}
					{{/list:item}}
				</div>
					{{list:default}}
						Journal is empty.
					{{/list:default}}
				{{/list}}
			</div>
			<div class="journal-sidebar span4">
				<div class="well">
					<h2 class="text-center">Most popular</h2>
					{{apply template="days_list" days="{$#popular_days}"/}}
				</div>
				<div class="well">
					<h2 class="text-center">New days</h2>
					{{apply template="days_list" days="{$#new_days}"/}}
				</div>
			</div>
		</div>
  {{/into}}
{{/wrap}}
